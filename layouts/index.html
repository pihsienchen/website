{{ define "main" }}
<div class="homepage-container">
  <!-- Language Dropdown -->
  <div class="homepage-language-dropdown">
    {{ partial "language-dropdown.html" (dict "Site" .Site "id" "homepage") }}
  </div>
  
  <!-- Hero Section with Autogram -->
  <section class="hero-section">
    <div class="autogram-container">
      {{ if or (eq .Site.Language.Lang "zh") (eq .Site.Language.Lang "zh-tw") }}
        <img src="/images/pi-hsien-autogram-zh-placeholder.png" alt="{{ .Site.Title }}" class="autogram-signature">
      {{ else }}
        <img src="/images/pi-hsien-autogram-en-placeholder.png" alt="{{ .Site.Title }}" class="autogram-signature">
      {{ end }}
    </div>
    
    <!-- Main Navigation Menu -->
    <nav class="main-navigation" id="main-nav">
      <ul class="nav-menu">
        {{ range .Site.Menus.main }}
          <li class="nav-item">
            <a href="{{ .URL | relLangURL }}" class="nav-link">{{ .Name }}</a>
          </li>
        {{ end }}
      </ul>
      
      <!-- Language dropdown in sticky nav -->
      <div class="sticky-nav-language">
        {{ partial "language-dropdown.html" (dict "Site" .Site "id" "sticky") }}
      </div>
    </nav>
    
    <!-- Scroll Indicator -->
    <div class="scroll-indicator">
      <div class="scroll-arrows">
        <div class="arrow-down"></div>
        <div class="arrow-down"></div>
        <div class="arrow-down"></div>
      </div>
    </div>
  </section>

  <!-- Preview Sections -->
  <section class="preview-sections" id="preview">
    <!-- Biography Section -->
    <a href="{{ "biography" | relLangURL }}" class="preview-section">
      <div class="section-info">
        <h2>
          {{ if eq .Site.Language.Lang "de" }}
            Biografie
          {{ else if eq .Site.Language.Lang "fr" }}
            Biographie
          {{ else if eq .Site.Language.Lang "zh" }}
            传记
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            傳記
          {{ else }}
            Biography
          {{ end }}
        </h2>
        <p>
          {{ if eq .Site.Language.Lang "de" }}
            Entdecken Sie die musikalische Reise und künstlerische Entwicklung von Pi-hsien Chen.
          {{ else if eq .Site.Language.Lang "fr" }}
            Découvrez le voyage musical et le développement artistique de Pi-hsien Chen.
          {{ else if eq .Site.Language.Lang "zh" }}
            探索陈丕先的音乐之旅和艺术发展历程。
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            探索陳丕先的音樂之旅和藝術發展歷程。
          {{ else }}
            Explore the musical journey and artistic development of Pi-hsien Chen.
          {{ end }}
        </p>
      </div>
      <div class="section-gallery">
        <div class="gallery-container">
          {{ $page := . }}
          {{ range $i := (seq 16) }}
            <div class="gallery-item">
              <img src="/images/placeholder.png" alt="Biography placeholder">
            </div>
          {{ end }}
        </div>
      </div>
    </a>

    <!-- Recordings Section -->
    <a href="{{ "recordings" | relLangURL }}" class="preview-section">
      <div class="section-info">
        <h2>
          {{ if eq .Site.Language.Lang "de" }}
            Aufnahmen
          {{ else if eq .Site.Language.Lang "fr" }}
            Enregistrements
          {{ else if eq .Site.Language.Lang "zh" }}
            录音
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            錄音
          {{ else }}
            Recordings
          {{ end }}
        </h2>
        <p>
          {{ if eq .Site.Language.Lang "de" }}
            Durchstöbern Sie das komplette Aufnahmearchiv mit Werken der großen Komponisten.
          {{ else if eq .Site.Language.Lang "fr" }}
            Parcourez les archives d'enregistrements complets avec des œuvres des grands compositeurs.
          {{ else if eq .Site.Language.Lang "zh" }}
            浏览完整的录音档案，包含伟大作曲家的作品。
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            瀏覽完整的錄音檔案，包含偉大作曲家的作品。
          {{ else }}
            Browse the complete recording archive featuring works by great composers.
          {{ end }}
        </p>
      </div>
      <div class="section-gallery">
        <div class="gallery-container">
          {{ $page := . }}
          {{ range $i := (seq 16) }}
            <div class="gallery-item">
              <img src="/images/placeholder.png" alt="Recordings placeholder">
            </div>
          {{ end }}
        </div>
      </div>
    </a>

    <!-- Masterclasses Section -->
    <a href="{{ "masterclasses" | relLangURL }}" class="preview-section">
      <div class="section-info">
        <h2>
          {{ if eq .Site.Language.Lang "de" }}
            Medien
          {{ else if eq .Site.Language.Lang "fr" }}
            Médias
          {{ else if eq .Site.Language.Lang "zh" }}
            媒体
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            媒體
          {{ else }}
            Masterclasses
          {{ end }}
        </h2>
        <p>
          {{ if eq .Site.Language.Lang "de" }}
            Professionelle Fotos und Pressematerialien für Medien und Veranstalter.
          {{ else if eq .Site.Language.Lang "fr" }}
            Photos professionnelles et matériel de presse pour les médias et organisateurs.
          {{ else if eq .Site.Language.Lang "zh" }}
            为媒体和主办方提供的专业照片和新闻资料。
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            為媒體和主辦方提供的專業照片和新聞資料。
          {{ else }}
            Educational resources and masterclass materials featuring interpretations by Pi-hsien Chen.
          {{ end }}
        </p>
      </div>
      <div class="section-gallery">
        <div class="gallery-container">
          {{ $page := . }}
          {{ range $i := (seq 16) }}
            <div class="gallery-item">
              <img src="/images/placeholder.png" alt="Masterclasses placeholder">
            </div>
          {{ end }}
        </div>
      </div>
    </a>

    <!-- Philanthropy Section -->
    <a href="{{ "philanthropy" | relLangURL }}" class="preview-section">
      <div class="section-info">
        <h2>
          {{ if eq .Site.Language.Lang "de" }}
            Philanthropie
          {{ else if eq .Site.Language.Lang "fr" }}
            Philanthropie
          {{ else if eq .Site.Language.Lang "zh" }}
            慈善事业
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            慈善事業
          {{ else }}
            Philanthropy
          {{ end }}
        </h2>
        <p>
          {{ if eq .Site.Language.Lang "de" }}
            Musikausbildung und humanitäre Initiativen zur Förderung der nächsten Generation.
          {{ else if eq .Site.Language.Lang "fr" }}
            Éducation musicale et initiatives humanitaires pour soutenir la prochaine génération.
          {{ else if eq .Site.Language.Lang "zh" }}
            音乐教育和人道主义倡议，支持下一代的发展。
          {{ else if eq .Site.Language.Lang "zh-tw" }}
            音樂教育和人道主義倡議，支持下一代的發展。
          {{ else }}
            Music education and humanitarian initiatives supporting the next generation.
          {{ end }}
        </p>
      </div>
      <div class="section-gallery">
        <div class="gallery-container">
          {{ $page := . }}
          {{ range $i := (seq 16) }}
            <div class="gallery-item">
              <img src="/images/placeholder.png" alt="Philanthropy placeholder">
            </div>
          {{ end }}
        </div>
      </div>
    </a>
  </section>
</div>

<!-- Footer -->
{{ partial "site-footer.html" . }}

<!-- Sticky Navigation JavaScript -->
<script>
window.addEventListener('scroll', function() {
    const nav = document.getElementById('main-nav');
    const heroSection = document.querySelector('.hero-section');
    const heroHeight = heroSection.offsetHeight;
    
    if (window.scrollY > heroHeight * 0.7) {
        nav.classList.add('sticky');
    } else {
        nav.classList.remove('sticky');
    }
});

// Smooth scroll to preview section
document.querySelector('.scroll-indicator').addEventListener('click', function() {
    document.getElementById('preview').scrollIntoView({
        behavior: 'smooth'
    });
});

// Gallery scrolling functionality
document.addEventListener('DOMContentLoaded', function() {
    const galleries = document.querySelectorAll('.gallery-container');
    
    galleries.forEach(gallery => {
        let isDown = false;
        let startX;
        let scrollLeft;
        let dragDistance = 0;
        let dragStarted = false;
        
        // Improved mouse wheel scrolling for high-speed mice
        gallery.addEventListener('wheel', function(e) {
            e.preventDefault();
            
            // Direct mapping of wheel delta for consistent behavior
            // Handle both regular scroll and high-speed Logitech mice
            let scrollAmount;
            
            // Detect if this is a high-speed scroll event
            if (Math.abs(e.deltaY) > 100) {
                // High-speed scroll: use larger multiplier for smooth fast scrolling
                scrollAmount = (e.deltaY > 0 ? 1 : -1) * Math.min(Math.abs(e.deltaY) * 2, 800);
            } else {
                // Regular scroll: use standard multiplier
                scrollAmount = e.deltaY * 3;
            }
            
            // Use instant scrolling for responsiveness
            gallery.scrollLeft += scrollAmount;
        }, { passive: false });
        
        // Enhanced drag scrolling with click protection
        gallery.addEventListener('mousedown', function(e) {
            // Only handle left mouse button
            if (e.button !== 0) return;
            
            isDown = true;
            dragStarted = false;
            dragDistance = 0;
            gallery.style.cursor = 'grabbing';
            startX = e.pageX - gallery.offsetLeft;
            scrollLeft = gallery.scrollLeft;
            e.preventDefault();
        });
        
        gallery.addEventListener('mouseleave', function() {
            isDown = false;
            gallery.style.cursor = 'grab';
        });
        
        gallery.addEventListener('mouseup', function(e) {
            if (isDown) {
                isDown = false;
                gallery.style.cursor = 'grab';
                
                // If significant drag occurred, prevent any click events
                if (dragStarted && dragDistance > 5) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                }
            }
        });
        
        gallery.addEventListener('mousemove', function(e) {
            if (!isDown) return;
            e.preventDefault();
            
            const x = e.pageX - gallery.offsetLeft;
            const walk = (x - startX) * 2;
            const currentDragDistance = Math.abs(walk);
            
            // Track total drag distance
            if (currentDragDistance > dragDistance) {
                dragDistance = currentDragDistance;
            }
            
            // Mark as drag if moved more than threshold
            if (dragDistance > 5) {
                dragStarted = true;
            }
            
            gallery.scrollLeft = scrollLeft - walk;
        });
        
        // Prevent clicks on gallery items after drag
        gallery.addEventListener('click', function(e) {
            if (dragStarted && dragDistance > 5) {
                e.preventDefault();
                e.stopPropagation();
                e.stopImmediatePropagation();
                return false;
            }
        }, true);
        
        // Touch events for mobile
        gallery.addEventListener('touchstart', function(e) {
            startX = e.touches[0].pageX - gallery.offsetLeft;
            scrollLeft = gallery.scrollLeft;
            dragStarted = false;
            dragDistance = 0;
        });
        
        gallery.addEventListener('touchmove', function(e) {
            if (!startX) return;
            const x = e.touches[0].pageX - gallery.offsetLeft;
            const walk = (x - startX) * 2;
            const currentDragDistance = Math.abs(walk);
            
            if (currentDragDistance > dragDistance) {
                dragDistance = currentDragDistance;
            }
            
            if (dragDistance > 5) {
                dragStarted = true;
            }
            
            gallery.scrollLeft = scrollLeft - walk;
        });
        
        gallery.addEventListener('touchend', function(e) {
            if (dragStarted && dragDistance > 5) {
                e.preventDefault();
                e.stopPropagation();
            }
        });
        
        // Set initial cursor
        gallery.style.cursor = 'grab';
    });
});
</script>
{{ end }}